-- API load

os.loadAPI('api/text')

local w, h = term.getSize()
term.setBackgroundColor(2048)
term.setTextColor(1)
term.clear()
clockTimer = os.startTimer(1)

function login()
term.clear()
text.cPrint("SkyOS", 2)
text.cWrite("Username: ", 4)
text.cWrite("Password: ", 6)
text.cWrite("Username: ", 4)
local name = read()
text.cWrite("Password: ", 6)
local pass = read('*')
file = fs.open("users/"..name,"r")
if not fs.exists("users/"..name) then
	text.cPrint('Login failed!', 8)
	sleep(0.5)
	login()
else
	local fileData = {}
	local line = file.readLine()
	repeat
		table.insert(fileData, line)
		line = file.readLine()
	until line == nil -- readLine()
		file.close()
		if pass == fileData[1] then
			text.cPrint("Login successfull!", 8)
			login = true
			sleep(0.5)
			desktop()

		else
			text.cPrint("Login failed", 8)
			sleep(0.5)
			login()
		end

end
end


function desktop()
	desktop = true
	term.clear()
	term.setCursorPos(1,1)
	term.setBackgroundColor('256')
	term.clearLine()


end

login()

while login do
	e, p1, p2, p3 = os.pullEvent()
	if e == 'timer' then
		clockTimer = os.startTimer(1)
		if desktop then
			local time = os.time()
			local formattedTime = textutils.formatTime(time, false)
			term.setCursorPos(1, w-10)
			write(formattedTime)
		end
	end
end